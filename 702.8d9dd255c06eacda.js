(self.webpackChunkdosmetal_app_frontend=self.webpackChunkdosmetal_app_frontend||[]).push([[702],{6702:(S,d,a)=>{"use strict";a.r(d),a.d(d,{RetirosModule:()=>j});var m=a(9808),v=a(2382),g=a(1598),u=a(5861),c=a(1764),p=a(3171),t=a(5e3),_=a(1135),h=a(2340),T=a(520);let C=(()=>{class n{constructor(e){this._http=e,this.URL=`${h.N.server_uri}/dosmetal/api/retiros`}getTodayRetiros(){return this._http.get(`${this.URL}/getToday`)}getMonthsRetiros(){return this._http.get(`${this.URL}/getMonths`)}getEspecificDay(e){return this._http.post(`${this.URL}/especificDay`,e)}setRetiros(e){return this._http.post(`${h.N.server_uri}/dosmetal/api/stock/retirar`,e)}}return n.\u0275fac=function(e){return new(e||n)(t.LFG(T.eN))},n.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();var l=a(8662);c.extend(p);let f=(()=>{class n{constructor(e,o){this.RetirosService=e,this.WebSocketService=o,this._RetirosSource=new _.X({day:"",dayEvents:[],timestamp:0,MonthID:""}),this._MonthSource=new _.X([]),this.Retiros$=this._RetirosSource.asObservable(),this.Months$=this._MonthSource.asObservable(),this.dayJS=c(),this.ActualDay=this.dayJS.date(),this.RetirosService.getTodayRetiros().subscribe({next:r=>{this._RetirosSource.next(r)}}),this.RetirosService.getMonthsRetiros().subscribe({next:r=>{this._MonthSource.next(r)}}),this.WebSocketService.fromEvent("[RETIROS] Get Changes").subscribe(r=>{console.log("Cambios en los retiros"),console.log(r),this.setRetirosToday(r)})}setRetirosDay(e,o){return this.RetirosService.getEspecificDay({MonthYear:e,ActualDay:o})}setRetirosMonth(e){const o=this.getRetirosMonths().map(r=>(r._id===e._id&&(r=e),r));this._MonthSource.next(o)}getRetirosMonths(){return this._MonthSource.getValue()}setRetirosToday(e){const o=this._RetirosSource.getValue();if(e._id===o._id)return o.dayEvents=e.dayEvents,void this._RetirosSource.next(o)}saveDetails(e,o,r){return(0,u.Z)(function*(){})()}}return n.\u0275fac=function(e){return new(e||n)(t.LFG(C),t.LFG(l.l))},n.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();var x=a(1198),M=a(8966);function y(n,i){if(1&n&&(t.TgZ(0,"span",5),t._uU(1),t.qZA()),2&n){const e=i.$implicit,o=i.index,r=t.oxw();t.xp6(1),t.lnq(" ",e.retiro," unidades de ",e.nombre," ",o===r.event.itemsRetirados.length-1?"":";"," ")}}let P=(()=>{class n{constructor(e){this.MaterialDialog=e,this.UpdateState=new t.vpe}ngOnInit(){}informState(){}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(M.uw))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-event-item"]],inputs:{event:"event"},outputs:{UpdateState:"UpdateState"},decls:8,vars:2,consts:[[1,"list-group-item","d-flex","justify-content-between","align-items-start","list-group-item-primary"],[1,"ms-2","me-auto"],[1,"fw-bold"],["class","text-secondary text-decoration-underline",4,"ngFor","ngForOf"],[1,"badge","bg-primary","rounded-pill","fw-normal",3,"click"],[1,"text-secondary","text-decoration-underline"]],template:function(e,o){1&e&&(t.TgZ(0,"li",0),t.TgZ(1,"div",1),t.TgZ(2,"div",2),t._uU(3," Se retiraron "),t.YNc(4,y,2,3,"span",3),t._uU(5),t.qZA(),t.qZA(),t.TgZ(6,"span",4),t.NdJ("click",function(){return o.informState()}),t._uU(7,"Informar Devoluci\xf3n"),t.qZA(),t.qZA()),2&e&&(t.xp6(4),t.Q6J("ngForOf",o.event.itemsRetirados),t.xp6(1),t.hij(" para ",o.event.nombreQuienRetira,". "))},directives:[m.sg],styles:["#inform[_ngcontent-%COMP%]{position:absolute;cursor:pointer;font-weight:400;top:1px;right:1px}"]}),n})();a(3634);let Z=(()=>{class n{transform(e){const o=c(e.timeStamp);let r=[];for(let s=1;s<=o.daysInMonth();s++){const O=e.days.find(D=>D.day===s.toString());1===s&&(r=this.getOffSets(e.timeStamp,s)),r.push({day_number:s,data:O})}return r}getOffSets(e,o){const s=c(e).set("date",o);return[...Array({lunes:0,martes:1,mi\u00e9rcoles:2,jueves:3,viernes:4,s\u00e1bado:5,domingo:6}[s.format("dddd")]).fill({day:"",data:void 0})]}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275pipe=t.Yjl({name:"transformToCalendar",type:n,pure:!0}),n})();function A(n,i){if(1&n&&(t.TgZ(0,"div",13),t._uU(1),t.qZA()),2&n){const e=t.oxw().$implicit;t.xp6(1),t.AsE(" ",e.data.dayEvents.length," ",e.data.dayEvents.length>1?"retiros":"retiro"," ")}}const b=function(n){return{have_data:n}},Y=function(n){return{"text-muted user-select-none":n}};function F(n,i){if(1&n){const e=t.EpF();t.TgZ(0,"li",10),t.NdJ("click",function(){const s=t.CHM(e).$implicit;return t.oxw(2).setDate(s.data)}),t.TgZ(1,"span",11),t._uU(2),t.qZA(),t.YNc(3,A,2,2,"div",12),t.qZA()}if(2&n){const e=i.$implicit;t.Q6J("ngClass",t.VKq(4,b,e.data&&e.data.dayEvents.length>0)),t.xp6(1),t.Q6J("ngClass",t.VKq(6,Y,e.data)),t.xp6(1),t.Oqu(e.day_number),t.xp6(1),t.Q6J("ngIf",e.data&&e.data.dayEvents.length>0)}}function w(n,i){if(1&n&&(t.TgZ(0,"div",3),t.TgZ(1,"div",4),t._uU(2),t.ALo(3,"uppercase"),t.qZA(),t.TgZ(4,"div",5),t.TgZ(5,"ul",6),t.TgZ(6,"li",7),t._uU(7,"Lun"),t.qZA(),t.TgZ(8,"li",7),t._uU(9,"Mar"),t.qZA(),t.TgZ(10,"li",7),t._uU(11,"M\xede"),t.qZA(),t.TgZ(12,"li",7),t._uU(13,"Jue"),t.qZA(),t.TgZ(14,"li",7),t._uU(15,"Vie"),t.qZA(),t.TgZ(16,"li",7),t._uU(17,"S\xe1b"),t.qZA(),t.TgZ(18,"li",7),t._uU(19,"Dom"),t.qZA(),t.qZA(),t.qZA(),t.TgZ(20,"div",8),t.TgZ(21,"ul"),t.YNc(22,F,4,8,"li",9),t.ALo(23,"transformToCalendar"),t.qZA(),t.qZA(),t.qZA()),2&n){const e=i.$implicit,o=t.oxw();t.xp6(2),t.hij(" ",t.lcZ(3,2,o.FormatDate(e.timeStamp).format("MMMM - YYYY"))," "),t.xp6(20),t.Q6J("ngForOf",t.lcZ(23,4,e))}}c.locale("es");let L=(()=>{class n{constructor(e){this.RetiroStore=e,this.MonthList=[],this.DayToSet=new t.vpe}ngOnInit(){this.RetiroStore.Months$.subscribe(e=>{this.MonthList=e.sort((o,r)=>r.timeStamp-o.timeStamp).map(o=>(o.days.sort((r,s)=>s.timestamp-r.timestamp),o))})}FormatDate(e){return c(e)}setDate(e){this.DayToSet.emit({dayID:e._id,dayTimestamp:e.timestamp,monthID:e.MonthID})}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(f))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-change-date-retiro"]],outputs:{DayToSet:"DayToSet"},decls:4,vars:1,consts:[[1,"title"],[1,"months"],["class","month",4,"ngFor","ngForOf"],[1,"month"],[1,"month_name"],[1,"month_week"],[1,"month_days"],[1,"month_day_name"],[1,"month_days_in"],["class","month_day_number",3,"ngClass","click",4,"ngFor","ngForOf"],[1,"month_day_number",3,"ngClass","click"],[3,"ngClass"],["class","data-msg text-primary",4,"ngIf"],[1,"data-msg","text-primary"]],template:function(e,o){1&e&&(t.TgZ(0,"h5",0),t._uU(1,"Cambiar Fecha de retiro"),t.qZA(),t.TgZ(2,"div",1),t.YNc(3,w,24,6,"div",2),t.qZA()),2&e&&(t.xp6(3),t.Q6J("ngForOf",o.MonthList))},directives:[m.sg,m.mk,m.O5],pipes:[m.gd,Z],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;width:100%;height:100%;overflow:auto;padding:.2rem}.title[_ngcontent-%COMP%]{margin:0;padding:.5rem;text-align:center;color:#fff}.months[_ngcontent-%COMP%]{display:grid;width:100%;height:100%;grid-template-columns:repeat(auto-fill,minmax(18rem,1fr));grid-gap:.5rem;gap:.5rem;padding:.5rem;overflow:auto;background-color:#fff;border-radius:5px}.months[_ngcontent-%COMP%]   .month[_ngcontent-%COMP%]{display:grid;width:100%;height:100%;grid-template-columns:100%;grid-template-rows:repeat(2,max-content) 1fr;border:2px solid #ccc;border-radius:5px;padding:.2rem}.months[_ngcontent-%COMP%]   .month[_ngcontent-%COMP%]   .month_name[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;padding:.2rem}.months[_ngcontent-%COMP%]   .month[_ngcontent-%COMP%]   .month_week[_ngcontent-%COMP%]{display:flex;width:100%;height:100%;border-radius:5px;overflow:hidden}.months[_ngcontent-%COMP%]   .month[_ngcontent-%COMP%]   .month_week[_ngcontent-%COMP%]   .month_days[_ngcontent-%COMP%]{display:grid;width:100%;height:100%;margin:0;list-style:none;grid-template-columns:repeat(7,1fr);background-color:#5f9ea0;color:#fff;padding:.2rem;text-align:center}.months[_ngcontent-%COMP%]   .month[_ngcontent-%COMP%]   .month_days_in[_ngcontent-%COMP%]{display:flex;width:100%;height:100%}.months[_ngcontent-%COMP%]   .month[_ngcontent-%COMP%]   .month_days_in[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{display:grid;width:100%;height:100%;list-style:none;padding:.2rem;margin:0;grid-template-columns:repeat(7,1fr);text-align:end;grid-gap:.1rem;gap:.1rem}.months[_ngcontent-%COMP%]   .month[_ngcontent-%COMP%]   .month_days_in[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   .month_day_number[_ngcontent-%COMP%]{display:flex;flex-direction:column;width:100%;height:max-content;border-radius:5px;padding:.2rem}.months[_ngcontent-%COMP%]   .month[_ngcontent-%COMP%]   .month_days_in[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   .month_day_number[_ngcontent-%COMP%]   .data-msg[_ngcontent-%COMP%]{font-size:10px}.months[_ngcontent-%COMP%]   .month[_ngcontent-%COMP%]   .month_days_in[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   .month_day_number.have_data[_ngcontent-%COMP%]{border:2px solid #ccc;cursor:pointer}.months[_ngcontent-%COMP%]   .month[_ngcontent-%COMP%]   .month_days_in[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   .month_day_number.have_data[_ngcontent-%COMP%]:hover{background-color:green;border-color:#fff!important}.months[_ngcontent-%COMP%]   .month[_ngcontent-%COMP%]   .month_days_in[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   .month_day_number.have_data[_ngcontent-%COMP%]:hover   .data-msg[_ngcontent-%COMP%], .months[_ngcontent-%COMP%]   .month[_ngcontent-%COMP%]   .month_days_in[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   .month_day_number.have_data[_ngcontent-%COMP%]:hover   span[_ngcontent-%COMP%]{color:#fff!important}"]}),n})();function E(n,i){if(1&n){const e=t.EpF();t.TgZ(0,"app-event-item",8),t.NdJ("UpdateState",function(r){return t.CHM(e),t.oxw(2).saveState(r)}),t.qZA()}2&n&&t.Q6J("event",i.$implicit)}function U(n,i){if(1&n&&(t.ynx(0),t.TgZ(1,"main",5),t.TgZ(2,"ul",6),t.YNc(3,E,1,1,"app-event-item",7),t.qZA(),t.qZA(),t.BQk()),2&n){const e=t.oxw();t.xp6(3),t.Q6J("ngForOf",e.eventsSelected)}}function I(n,i){if(1&n){const e=t.EpF();t.TgZ(0,"app-change-date-retiro",9),t.NdJ("DayToSet",function(r){return t.CHM(e),t.oxw().setDay(r)}),t.qZA()}}const J=function(n,i){return{"btn-primary":n,"btn-warning text-white":i}};c.extend(p);const q=[{path:"",component:(()=>{class n{constructor(e,o){this.RetiroStoreService=e,this.HeadService=o,this.dayJS=c(),this.events=[],this.eventsSelected=[],this.onChangeDate=!1,this.RetiroStoreService.Retiros$.subscribe(r=>{this.events=r.dayEvents,this.eventsSelected=r.dayEvents})}ngOnInit(){this.HeadService.setTitle("Retiros")}saveState(e){return(0,u.Z)(function*(){})()}changeDate(){this.onChangeDate=!this.onChangeDate}setDay(e){this.dayJS=c(e.dayTimestamp),this.RetiroStoreService.setRetirosDay(e.monthID,e.dayID).subscribe(o=>{this.eventsSelected=o,this.onChangeDate=!1})}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(f),t.Y36(x.k))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-retiros"]],decls:10,vars:9,consts:[[1,"wrapper","animate__animated","animate__slideInDown"],[1,"day","animate__animated","animate__bounce","animate__delay-1s"],[1,"btn","btn-sm","mt-1",3,"ngClass","click"],[4,"ngIf","ngIfElse"],["ChangeDateRetiroTemplate",""],[1,"events","p-1",2,"overflow","auto"],[1,"list-group"],[3,"event","UpdateState",4,"ngFor","ngForOf"],[3,"event","UpdateState"],[3,"DayToSet"]],template:function(e,o){if(1&e&&(t.TgZ(0,"div",0),t.TgZ(1,"header"),t._uU(2),t.TgZ(3,"span",1),t._uU(4),t.qZA(),t.TgZ(5,"button",2),t.NdJ("click",function(){return o.changeDate()}),t._uU(6),t.qZA(),t.qZA(),t.YNc(7,U,4,1,"ng-container",3),t.YNc(8,I,1,0,"ng-template",null,4,t.W1O),t.qZA()),2&e){const r=t.MAs(9);t.xp6(2),t.hij(" Retiros ",o.dayJS.format("MMMM YYYY")," "),t.xp6(2),t.hij(" ",o.dayJS.format("LLLL")," "),t.xp6(1),t.Q6J("ngClass",t.WLB(6,J,!o.onChangeDate,o.onChangeDate)),t.xp6(1),t.hij(" ",o.onChangeDate?"Volver":"Cambiar Fecha"," "),t.xp6(1),t.Q6J("ngIf",!o.onChangeDate)("ngIfElse",r)}},directives:[m.mk,m.O5,m.sg,P,L],styles:["[_nghost-%COMP%]{display:flex;width:100%;height:100%;justify-content:center;align-items:center;background:linear-gradient(to bottom,#606c88,#3f4c6b);border-radius:5px}.list-group-item[_ngcontent-%COMP%]{position:relative}.wrapper[_ngcontent-%COMP%]{display:grid;width:100%;height:100%;grid-template-columns:1fr;grid-template-rows:max-content 1fr}header[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:center;font-size:1.5rem;padding:.5rem;color:#fff;text-transform:uppercase;-webkit-user-select:none;user-select:none}header[_ngcontent-%COMP%]   .day[_ngcontent-%COMP%]{display:flex;border:2px solid #fff;background-color:#1abc9c;color:#fff;padding:0 1rem;font-size:1.2rem}@media (max-width: 992px){header[_ngcontent-%COMP%]{font-size:1rem}header[_ngcontent-%COMP%]   .day[_ngcontent-%COMP%]{font-size:.8rem}}"]}),n})()},{path:"**",redirectTo:""}];let N=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[[g.Bz.forChild(q)],g.Bz]}),n})();var k=a(1752),$=a(4586);let j=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[[m.ez,N,k.q,v.UX,$.D]]}),n})()},3171:function(S){S.exports=function(){"use strict";var d={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};return function(a,m,v){var g=m.prototype,u=g.format;v.en.formats=d,g.format=function(c){void 0===c&&(c="YYYY-MM-DDTHH:mm:ssZ");var h,p=this.$locale().formats,t=(h=void 0===p?{}:p,c.replace(/(\[[^\]]+])|(LTS?|l{1,4}|L{1,4})/g,function(T,C,l){var f=l&&l.toUpperCase();return C||h[l]||d[l]||h[f].replace(/(\[[^\]]+])|(MMMM|MM|DD|dddd)/g,function(x,M,y){return M||y.slice(1)})}));return u.call(this,t)}}}()}}]);